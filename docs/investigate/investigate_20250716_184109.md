# フロントエンドディレクトリ サブモジュール問題調査報告書

## 調査概要

**調査日時**: 2025-07-16 18:41:09  
**調査者**: Claude Code Assistant  
**調査対象**: フロントエンドディレクトリがサブモジュール化されている問題  
**調査ブランチ**: feature/frontend-submodule-fix  

## 問題の概要

フロントエンドディレクトリがGit上で閲覧できない問題が発生している。具体的には、`git status`で`frontend (untracked content)`として表示され、正常にバージョン管理されていない状態。

## 調査結果

### 1. 現在の状況

#### Git状態
```bash
# 親プロジェクトのgit status
On branch main
Changes not staged for commit:
  modified:   frontend (untracked content)

# サブモジュールの状態確認
$ git submodule status
fatal: no submodule mapping found in .gitmodules for path 'frontend'
```

#### ディレクトリ構成
- `/Users/daichirouesaka/Documents/90_duesk/monstera/.git` (親プロジェクト)
- `/Users/daichirouesaka/Documents/90_duesk/monstera/frontend/.git` (独立したGitリポジトリ)

#### frontendディレクトリの状態
- **現在のブランチ**: `bugfix/14-timeline-import-fix`
- **リモートリポジトリ**: `https://github.com/duesk-inc/monstera.git`
- **大量のuntrackedファイル**: 新規開発で追加されたファイルが多数存在

### 2. 問題の根本原因

1. **独立したGitリポジトリとして存在**
   - frontendディレクトリが独自の`.git`ディレクトリを持っている
   - 親プロジェクトから独立したGitリポジトリとして動作

2. **正式なサブモジュールとして設定されていない**
   - `.gitmodules`ファイルが存在しない
   - `git submodule`コマンドで認識されない

3. **現在のプロジェクト構成との不整合**
   - プロジェクトはモノレポ構成を前提として設計されている
   - `docker-compose.yml`、`Makefile`、`README.md`すべてでfrontendディレクトリが直接参照されている

### 3. 技術的制約

#### 現在の開発ワークフロー
- `make setup`: frontendディレクトリで`npm install`を実行
- `make dev`: Docker Composeでfrontendサービスを起動
- `make test-frontend`: frontendディレクトリでテストを実行
- `make lint`: frontendディレクトリでリントを実行

#### 依存関係
- **Docker Compose**: `./frontend:/app`でボリュームマウント
- **Makefile**: `cd frontend && npm install`等のコマンド
- **開発環境**: http://localhost:3000でフロントエンドアクセス

### 4. 解決方針の検討

#### 方針1: 推奨解決策 - 親プロジェクトへの統合
**概要**: frontendディレクトリを親プロジェクトに統合し、モノレポ構成に戻す

**メリット**:
- 現在の開発ワークフローを維持
- Docker ComposeやMakefileの修正不要
- CI/CDパイプラインが単純
- 開発者の学習コストが最小

**デメリット**:
- frontendディレクトリの独立したGit履歴が失われる可能性
- 一時的に作業が必要

**実装手順**:
1. frontendディレクトリの重要なファイルをバックアップ
2. frontendディレクトリの`.git`ディレクトリを削除
3. frontendディレクトリのファイルを親プロジェクトに統合
4. 必要に応じて`.gitignore`の調整

#### 方針2: 代替解決策 - 正式なサブモジュール設定
**概要**: `.gitmodules`ファイルを作成し、frontendディレクトリを正式なサブモジュールとして登録

**メリット**:
- frontendディレクトリの独立性を維持
- Git履歴の保持
- 将来的な分離が容易

**デメリット**:
- 開発ワークフローの変更が必要
- サブモジュールの複雑性増加
- 開発者の学習コストが高い

#### 方針3: 完全分離
**概要**: frontendディレクトリを別リポジトリに移動し、親プロジェクトから除外

**メリット**:
- 完全な独立性
- 個別のデプロイ可能

**デメリット**:
- 大幅な開発ワークフローの変更
- Docker ComposeやMakefileの大幅修正
- CI/CDパイプラインの複雑化

### 5. 推奨事項

**推奨解決策**: 方針1（親プロジェクトへの統合）

**理由**:
1. 現在のプロジェクト構成（モノレポ）に最適
2. 開発ワークフローの変更が最小限
3. 技術的複雑性が低い
4. 開発者の生産性に与える影響が最小

**実装リスク**:
- 低リスク：既存の開発ワークフローを維持
- 中リスク：一時的な作業が必要
- 高リスク：なし

## 次のステップ

### 即座に実行可能な対策
1. frontendディレクトリのバックアップ作成
2. `.git`ディレクトリの削除
3. ファイルの統合とコミット

### 中長期的な対策
1. 開発ワークフローの文書化
2. 同様の問題の防止策検討
3. プロジェクト構成の明確化

## 関連ファイル

- `docker-compose.yml`: frontendサービスの定義
- `Makefile`: frontend関連のコマンド定義
- `README.md`: セットアップ手順
- `.gitignore`: frontend関連の除外設定

## 備考

本調査は feature/frontend-submodule-fix ブランチで実施され、実装に向けた具体的な手順とリスク評価を含んでいる。推奨解決策の実装により、プロジェクトの正常なバージョン管理が復旧することが期待される。