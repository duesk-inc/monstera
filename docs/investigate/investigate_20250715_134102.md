# Sidebar Import Error 調査結果

## 調査概要
- **日時**: 2025-07-15 13:41:02
- **対象**: ログインページで発生した Sidebar コンポーネントインポートエラー
- **ブランチ**: fix/sidebar-component-import
- **エラー内容**: `Module not found: Can't resolve '@/components/common/Sidebar'`

## エラー詳細
```
Module not found: Can't resolve '@/components/common/Sidebar'
./src/app/(authenticated)/layout.tsx (5:1)
  3 | import React, { useState } from 'react';
  4 | import { MenuItem, Typography, Avatar } from '@mui/material';
> 5 | import Sidebar from '@/components/common/Sidebar';
    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  6 | import { SharedLayoutWrapper } from '@/components/common/layout';
```

## 根本原因分析

### 1. ファイル構造の問題
- **要求されたパス**: `@/components/common/Sidebar`
- **実際の状況**: このパスにSidebarコンポーネントが存在しない
- **存在する類似コンポーネント**: `@/components/ui/AdminSidebar`

### 2. レイアウト構造の比較
#### Admin Layout (`/app/(admin)/layout.tsx`)
```typescript
import AdminSidebar from '@/components/ui/AdminSidebar';
// 正常に動作 - 正しいパスを使用
```

#### Authenticated Layout (`/app/(authenticated)/layout.tsx`)
```typescript
import Sidebar from '@/components/common/Sidebar';  // エラー - ファイルが存在しない
```

### 3. コンポーネント使用方法の相違点
両方のレイアウトで同じpropsを期待:
- `open: boolean`
- `onToggle?: () => void`
- `mobile?: boolean`
- `onClose?: () => void`

## 技術的検証結果

### 1. ファイル存在確認
```bash
# 実際に存在するSidebar関連ファイル
✓ frontend/src/components/ui/AdminSidebar.tsx
✗ frontend/src/components/common/Sidebar.tsx (存在しない)

# カバレッジファイルから過去の存在を確認
✓ frontend/coverage/lcov-report/src/components/ui/Sidebar.tsx.html
```

### 2. Git履歴調査
```bash
# Sidebar関連のマージコミット発見
06ba431 Merge pull request #5 from duesk-inc/feature/sidebar-layout
```

### 3. インポート使用箇所
- `@/components/common/Sidebar`: 1箇所 (エラー発生箇所)
- `AdminSidebar`: 2箇所 (正常動作)

## 解決方針

### A. 短期的解決 (推奨)
**一時的にAdminSidebarを使用**
```typescript
// Before
import Sidebar from '@/components/common/Sidebar';

// After
import AdminSidebar from '@/components/ui/AdminSidebar';
```

**メリット**:
- 即座にエラー解消
- 既存のprops互換性あり
- 実装コストゼロ

**デメリット**:
- 管理者向けメニューが一般ユーザーに表示される可能性

### B. 中期的解決
**一般ユーザー向けSidebarコンポーネント作成**
1. `@/components/common/Sidebar.tsx`を新規作成
2. 一般ユーザー向けメニュー項目定義
3. AdminSidebarと同じprops interfaceを実装

**メリット**:
- 適切な権限分離
- 将来の拡張性

**デメリット**:
- 実装工数が必要
- コードの重複リスク

### C. 長期的解決
**汎用Sidebarコンポーネントの設計**
1. 基底Sidebarコンポーネント作成
2. メニュー項目をpropsで注入
3. 役割ベースのメニュー表示制御

## 推奨実装手順

### Phase 1: 緊急修正
1. `layout.tsx`のインポートパスを`AdminSidebar`に変更
2. 動作確認とテスト実行
3. コミット・デプロイ

### Phase 2: 適切な分離 (後日実装)
1. 一般ユーザー向けメニュー仕様策定
2. `@/components/common/Sidebar.tsx`実装
3. `layout.tsx`のインポートパス修正
4. テスト実装

## 技術的制約・考慮事項

### 1. Props互換性
既存のSharedLayoutWrapperとの互換性を維持する必要あり:
```typescript
interface SidebarProps {
  mobile?: boolean;
  onClose?: () => void;
  open: boolean;
  onToggle?: () => void;
}
```

### 2. 権限制御
- AdminSidebarには管理者専用メニューが含まれる
- 一般ユーザーに不適切なメニューが表示される可能性

### 3. UI/UX一貫性
- デザインシステムとの整合性
- レスポンシブ対応
- アクセシビリティ対応

## 関連ファイル
- `frontend/src/app/(authenticated)/layout.tsx` (修正対象)
- `frontend/src/app/(admin)/layout.tsx` (参考実装)
- `frontend/src/components/ui/AdminSidebar.tsx` (既存コンポーネント)
- `frontend/src/components/common/layout/SharedLayoutWrapper.tsx` (レイアウトラッパー)

## 次フェーズへの推奨事項
1. **即座に実装**: AdminSidebarを使用した緊急修正
2. **短期計画**: 一般ユーザー向けSidebarコンポーネント設計
3. **長期計画**: サイドバーアーキテクチャの統一化

## ログ
- ブランチ作成: `fix/sidebar-component-import`
- 調査完了: 2025-07-15 13:41:02
- 次フェーズ: PLAN (実装計画策定)