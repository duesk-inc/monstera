# èª¿æŸ»å ±å‘Šæ›¸: @/constants/auth ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«è§£æ±ºã‚¨ãƒ©ãƒ¼

## èª¿æŸ»æ¦‚è¦

**èª¿æŸ»æ—¥æ™‚**: 2025-07-17 09:56:46  
**èª¿æŸ»è€…**: Claude Code  
**ãƒ–ãƒ©ãƒ³ãƒ**: feature/fix-auth-constants-error  
**ã‚¨ãƒ©ãƒ¼æ¦‚è¦**: Module not found: Can't resolve '@/constants/auth'

## ã‚¨ãƒ©ãƒ¼è©³ç´°

```
Build Error

Module not found: Can't resolve '@/constants/auth'

./src/middleware.ts (4:1)

Module not found: Can't resolve '@/constants/auth'
  2 | import type { NextRequest } from 'next/server';
  3 | import { ROUTES, PUBLIC_PATHS } from '@/constants/routes';
> 4 | import { AUTH_COOKIES } from '@/constants/auth';
    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  5 |
  6 | // ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰
  7 | const DEBUG_MODE = process.env.NODE_ENV === 'development';
```

## æ ¹æœ¬åŸå› åˆ†æ

### 1. ä¸è¶³ãƒ•ã‚¡ã‚¤ãƒ«ã®ç‰¹å®š

èª¿æŸ»ã«ã‚ˆã‚Šã€ä»¥ä¸‹ã®2ã¤ã®å®šæ•°ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ãªã„ã“ã¨ãŒåˆ¤æ˜ï¼š

1. **`@/constants/auth.ts`** - èªè¨¼é–¢é€£å®šæ•°
2. **`@/constants/routes.ts`** - ãƒ«ãƒ¼ãƒˆé–¢é€£å®šæ•°

### 2. middleware.tsã§ã®ä½¿ç”¨çŠ¶æ³

```typescript
// ç¾åœ¨ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆï¼ˆã‚¨ãƒ©ãƒ¼ç™ºç”Ÿç®‡æ‰€ï¼‰
import { ROUTES, PUBLIC_PATHS } from '@/constants/routes';
import { AUTH_COOKIES } from '@/constants/auth';

// ä½¿ç”¨ç®‡æ‰€
- AUTH_COOKIES.ACCESS_TOKEN (53è¡Œç›®)
- ROUTES.LOGIN (99, 109, 118è¡Œç›®)
- ROUTES.DASHBOARD (122è¡Œç›®)
- PUBLIC_PATHS (17è¡Œç›®)
```

### 3. æ—¢å­˜constants/ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®çŠ¶æ³

```
frontend/src/constants/
â”œâ”€â”€ accounting.ts
â”œâ”€â”€ business-rules.ts
â”œâ”€â”€ cache.ts
â”œâ”€â”€ date.ts
â”œâ”€â”€ defaultWorkTime.ts
â”œâ”€â”€ delays.ts
â”œâ”€â”€ dimensions.ts
â”œâ”€â”€ engineer.ts
â”œâ”€â”€ errorMessages.ts
â”œâ”€â”€ expense.ts
â”œâ”€â”€ moodOptions.ts
â”œâ”€â”€ pagination.ts
â”œâ”€â”€ sales.ts
â”œâ”€â”€ typography.ts
â”œâ”€â”€ ui.ts
â”œâ”€â”€ validationMessages.ts
â”œâ”€â”€ weeklyMood.ts
â””â”€â”€ weeklyReport.ts
```

**çµæœ**: `auth.ts`ã¨`routes.ts`ãŒå­˜åœ¨ã—ãªã„

## æŠ€è¡“ä»•æ§˜èª¿æŸ»çµæœ

### 1. èªè¨¼ã‚·ã‚¹ãƒ†ãƒ ä»•æ§˜

ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰èªè¨¼ä»•æ§˜æ›¸ï¼ˆ`docs/01_backend/implementation/auth-implementation.md`ï¼‰ã‹ã‚‰å–å¾—ï¼š

**Cookieåå®šç¾©**:
- ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³: `"access_token"`
- ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³: `"refresh_token"`

**è¨­å®šæ§‹é€ **:
```go
type JWTConfig struct {
    AccessCookieName    string // ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³Cookieå
    RefreshCookieName   string // ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³Cookieå
}
```

### 2. ãƒ«ãƒ¼ãƒˆæ§‹é€ åˆ†æ

Next.js App Routerãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã‹ã‚‰æ¨æ¸¬ï¼š

**èªè¨¼é–¢é€£ãƒ«ãƒ¼ãƒˆ**:
- ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸: `/login` (`app/(auth)/login/page.tsx`)

**ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰é–¢é€£ãƒ«ãƒ¼ãƒˆ**:
- ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰: `/dashboard` (`app/(authenticated)/(engineer)/dashboard/page.tsx`)
- ç®¡ç†è€…ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰: `/admin/dashboard` (`app/(admin)/admin/dashboard/page.tsx`)

**å…¬é–‹ãƒ‘ã‚¹ï¼ˆèªè¨¼ä¸è¦ãƒ‘ã‚¹ï¼‰**:
- `/login` - ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸
- `/` - ãƒ«ãƒ¼ãƒˆãƒšãƒ¼ã‚¸
- é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆmiddlewareè¨­å®šã§é™¤å¤–ï¼‰

## è§£æ±ºæ–¹é‡

### 1. å¿…è¦ãªå®šæ•°ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ

#### A. `constants/auth.ts`

```typescript
export const AUTH_COOKIES = {
  ACCESS_TOKEN: 'access_token',
  REFRESH_TOKEN: 'refresh_token',
} as const;

export type AuthCookies = typeof AUTH_COOKIES;
```

#### B. `constants/routes.ts`

```typescript
export const ROUTES = {
  LOGIN: '/login',
  DASHBOARD: '/dashboard',
  ADMIN_DASHBOARD: '/admin/dashboard',
} as const;

export const PUBLIC_PATHS = [
  '/',
  '/login',
] as const;

export type Routes = typeof ROUTES;
export type PublicPaths = typeof PUBLIC_PATHS[number];
```

### 2. å®Ÿè£…å„ªå…ˆåº¦

1. **é«˜**: `constants/auth.ts` - middleware.tsã®å³åº§ã®ä¿®æ­£ã«å¿…è¦
2. **é«˜**: `constants/routes.ts` - middleware.tsã®å³åº§ã®ä¿®æ­£ã«å¿…è¦
3. **ä¸­**: å‹å®šç¾©ã®è¿½åŠ ã¨ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
4. **ä½**: æ—¢å­˜ã‚³ãƒ¼ãƒ‰ã§ã®åˆ©ç”¨ç®‡æ‰€ã®çµ±ä¸€

## æŠ€è¡“çš„åˆ¶ç´„ãƒ»è€ƒæ…®äº‹é …

### 1. Next.jsè¨­å®šç¢ºèª

- `@`ã‚¨ã‚¤ãƒªã‚¢ã‚¹ãŒ`src`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æŒ‡ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªæ¸ˆã¿
- ãƒ‘ã‚¹è§£æ±ºã«å•é¡Œãªã—

### 2. TypeScriptè¨­å®š

- æ—¢å­˜ã®constants/ãƒ•ã‚¡ã‚¤ãƒ«ã¨åŒæ§˜ã®å‹å®‰å…¨æ€§ã‚’ç¢ºä¿
- `as const`ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ã®ä½¿ç”¨

### 3. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è€ƒæ…®

- Cookieåã¯å…¬é–‹æƒ…å ±ï¼ˆãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°å•é¡Œãªã—ï¼‰
- ãƒ«ãƒ¼ãƒˆæƒ…å ±ã‚‚å…¬é–‹æƒ…å ±

## æ¬¡ãƒ•ã‚§ãƒ¼ã‚ºã¸ã®æ¨å¥¨äº‹é …

### å®Ÿè£…æ¨å¥¨

**ç†ç”±**:
1. ã‚¨ãƒ©ãƒ¼ã¯æ˜ç¢ºã«ç‰¹å®šã•ã‚ŒãŸä¸è¶³ãƒ•ã‚¡ã‚¤ãƒ«ãŒåŸå› 
2. ä»•æ§˜æ›¸ã«åŸºã¥ãé©åˆ‡ãªå®šæ•°å€¤ãŒç‰¹å®šæ¸ˆã¿
3. å®Ÿè£…ç¯„å›²ãŒé™å®šçš„ã§å½±éŸ¿ç¯„å›²ãŒæ˜ç¢º
4. æ—¢å­˜ã‚³ãƒ¼ãƒ‰ã¨ã®æ•´åˆæ€§ç¢ºä¿ãŒå¯èƒ½

**å®Ÿè£…ä½œæ¥­é …ç›®**:
1. `constants/auth.ts`ã®ä½œæˆ
2. `constants/routes.ts`ã®ä½œæˆ
3. middleware.tsãƒ“ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼ã®ç¢ºèª
4. å‹å®šç¾©ã®æ¤œè¨¼

## èª¿æŸ»çµæœã‚µãƒãƒª

| é …ç›® | çŠ¶æ³ | å¯¾å¿œè¦å¦ |
|------|------|----------|
| ã‚¨ãƒ©ãƒ¼åŸå›  | âœ… ç‰¹å®šå®Œäº† | - |
| ä¸è¶³ãƒ•ã‚¡ã‚¤ãƒ« | âœ… 2ãƒ•ã‚¡ã‚¤ãƒ«ç‰¹å®š | ğŸ”´ ä½œæˆå¿…è¦ |
| ä»•æ§˜ç¢ºèª | âœ… å®Œäº† | - |
| å®Ÿè£…æ–¹é‡ | âœ… æ±ºå®š | - |
| å½±éŸ¿ç¯„å›² | âœ… é™å®šçš„ | - |

## é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«

- `frontend/src/middleware.ts` - ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿç®‡æ‰€
- `docs/01_backend/implementation/auth-implementation.md` - èªè¨¼ä»•æ§˜æ›¸
- `docs/02_frontend/specification.md` - ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ä»•æ§˜æ›¸

---

**ãƒ–ãƒ©ãƒ³ãƒ**: feature/fix-auth-constants-error  
**æ¬¡ãƒ•ã‚§ãƒ¼ã‚º**: PLAN - å®Ÿè£…è¨ˆç”»ç­–å®šæ¨å¥¨