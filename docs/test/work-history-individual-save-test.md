# 職務経歴個別保存機能テスト手順書

## 概要
職務経歴の個別保存機能が正しく動作することを確認するためのテスト手順書です。

## 前提条件
- フィーチャーフラグ `NEXT_PUBLIC_INDIVIDUAL_WORK_HISTORY_SAVE=true` が設定されていること
- 開発環境が起動していること（docker-compose up -d）
- フロントエンド・バックエンドのサーバーが起動していること

## テスト項目

### 1. 個別保存ボタンの表示確認
1. スキルシート画面（http://localhost:3000/skill-sheet）にアクセス
2. 職務経歴の編集ボタンをクリック
3. 編集ダイアログが開くことを確認
4. ダイアログの下部に以下のボタンが表示されることを確認：
   - 「個別保存」ボタン（クラウドアップロードアイコン付き）
   - 「保存して閉じる」ボタン

### 2. 新規作成時の個別保存
1. 「職務経歴を追加」ボタンをクリック
2. 必須項目を入力：
   - プロジェクト名: テストプロジェクト
   - 開始年月: 2023年1月
   - 業種: IT・通信
   - 役割: SE
   - チーム規模: 5
3. プロジェクト詳細を入力：
   - プロジェクト概要: テスト用のプロジェクト
   - 担当業務: 開発とテスト
   - 成果・実績: 品質向上に貢献
   - 担当工程: 製造・実装を選択
4. 「個別保存」ボタンをクリック
5. 「職務経歴を作成しました」というトーストメッセージが表示されることを確認
6. ダイアログが閉じることを確認
7. 作成した職務経歴が一覧に表示されることを確認

### 3. 既存データの個別更新
1. 既存の職務経歴の編集ボタンをクリック
2. プロジェクト名を変更（例：「更新テスト」を追加）
3. 「個別保存」ボタンをクリック
4. 「職務経歴を更新しました」というトーストメッセージが表示されることを確認
5. ダイアログが閉じることを確認
6. 更新内容が一覧に反映されていることを確認

### 4. 個別削除
1. 削除対象の職務経歴の削除ボタンをクリック
2. 確認ダイアログが表示されることを確認
3. 「削除」ボタンをクリック
4. 「職務経歴を削除しました」というトーストメッセージが表示されることを確認
5. 削除した職務経歴が一覧から消えることを確認

### 5. バリデーション確認
1. 「職務経歴を追加」ボタンをクリック
2. 必須項目を入力せずに「個別保存」ボタンをクリック
3. 各必須項目にエラーメッセージが表示されることを確認：
   - プロジェクト名: 「プロジェクト名を入力してください」
   - 開始年月: 「開始年月を選択してください」
   - 業種: 「業種を選択してください」
   - 役割: 「役割を選択してください」
   - チーム規模: 「チーム規模を入力してください」

### 6. API連携確認（開発者向け）
1. ブラウザの開発者ツールを開く
2. Networkタブを選択
3. 個別保存を実行
4. 以下のAPIエンドポイントが呼ばれることを確認：
   - 新規作成時: `POST /api/v1/work-history`
   - 更新時: `PUT /api/v1/work-history/{id}`
   - 削除時: `DELETE /api/v1/work-history/{id}`

### 7. フィーチャーフラグ無効時の動作確認
1. `.env.local`の`NEXT_PUBLIC_INDIVIDUAL_WORK_HISTORY_SAVE=false`に変更
2. フロントエンドを再起動
3. 職務経歴の編集ダイアログを開く
4. 「個別保存」ボタンが表示されないことを確認
5. 従来通りの「保存」ボタンのみが表示されることを確認

## エラー時の対処

### APIエラーが発生する場合
1. バックエンドのログを確認: `docker-compose logs -f backend`
2. データベースの接続を確認: `docker-compose ps`
3. Cognitoの設定を確認

### UIが更新されない場合
1. ブラウザのキャッシュをクリア
2. フロントエンドを再起動: `npm run dev`
3. React Developer Toolsで状態を確認

## 確認済み項目チェックリスト
- [ ] 個別保存ボタンの表示
- [ ] 新規作成時の個別保存
- [ ] 既存データの個別更新
- [ ] 個別削除
- [ ] バリデーション
- [ ] API連携
- [ ] フィーチャーフラグの動作

## 備考
- このテストは開発環境で実施すること
- テストデータは必要に応じて削除すること
- 本番環境へのデプロイ前に必ず全項目をテストすること