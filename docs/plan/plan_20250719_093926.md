# エンジニア専用サイドバー実装計画

## 計画作成日時
2025-01-19 09:39:26

## 概要
エンジニアロール（employee/user）でログイン時に専用のサイドバーを表示する機能を実装する。

## 実装方針
- AdminSidebarコンポーネントの構造・スタイルを踏襲
- ActiveRoleContextを使用したロール判定
- 段階的な実装アプローチ

## 詳細実装タスク

### 1. EngineerSidebarコンポーネントの作成（優先度：高）
**作業内容：**
- AdminSidebarをベースに新規コンポーネント作成
- エンジニア向けメニュー項目の定義
- アイコンとルーティングパスの設定

**メニュー構成：**
```typescript
const menuItems = [
  { title: "ダッシュボード", icon: DashboardIcon, path: "/dashboard" },
  { title: "週報", icon: WeeklyReportIcon, path: "/weekly-report" },
  { title: "勤怠管理", icon: AttendanceIcon, path: "/attendance" },
  { title: "経費申請", icon: ExpenseIcon, path: "/expenses" },
  { title: "休暇申請", icon: LeaveIcon, path: "/leave" },
  { title: "スキルシート", icon: SkillSheetIcon, path: "/skill-sheet" },
  { title: "職務経歴", icon: WorkHistoryIcon, path: "/work-history" },
  { title: "提案管理", icon: ProposalIcon, path: "/proposals" },
  { title: "通知設定", icon: NotificationsIcon, path: "/notifications/settings" },
  { title: "プロフィール", icon: ProfileIcon, path: "/profile" }
];
```

### 2. レイアウトファイルの更新（優先度：高）
**作業内容：**
- ActiveRoleContextのインポートとuseActiveRoleフックの使用
- ロール判定ロジックの実装
- 条件分岐によるサイドバーコンポーネントの切り替え

**実装例：**
```typescript
const { activeRole } = useActiveRole();
const isEngineer = activeRole === 'employee' || activeRole === 'user';

// サイドバーの選択
const sidebar = isEngineer ? (
  <EngineerSidebar open={sidebarOpen} onToggle={handleSidebarToggle} />
) : (
  <AdminSidebar open={sidebarOpen} onToggle={handleSidebarToggle} />
);
```

### 3. 動作確認（優先度：中）
**作業内容：**
- engineer_test@duesk.co.jpでのログインテスト
- サイドバーの表示確認
- メニュー項目のクリックとナビゲーション確認
- モバイル表示の確認

## ファイル変更計画

### 新規作成
- `/frontend/src/components/ui/EngineerSidebar.tsx`
  - エンジニア専用サイドバーコンポーネント
  - AdminSidebarと同じPropsインターフェース
  - エンジニア向けメニュー項目のみ

### 修正
- `/frontend/src/app/(authenticated)/layout.tsx`
  - ActiveRoleContextのインポート追加
  - useActiveRoleフックの使用
  - ロール判定によるサイドバー切り替えロジック

### 削除
- なし

## テスト戦略

### 1. 単体テスト
- UIコンポーネントのため省略可能

### 2. 統合テスト
- ロール判定の動作確認
- コンポーネントの切り替え確認

### 3. E2Eテスト（手動）
- engineer_test@duesk.co.jpでログイン
- エンジニアサイドバーの表示確認
- メニュー項目のクリックとページ遷移確認
- モバイル表示での動作確認
- 管理者ロールでのAdminSidebar表示確認

## リスク分析と対策

### リスク1：ロール判定の誤動作
- **影響度：高**
- **対策：ActiveRoleContextの正しい使用とテスト】

### リスク2：不適切なメニュー項目の表示
- **影響度：中**
- **対策：エンジニア向けのパスのみを設定**

### リスク3：複数ロール保持ユーザーの挙動
- **影響度：低**
- **対策：ActiveRoleContextのロール切り替え機能を活用**

## 実装スケジュール

### Phase 1：コンポーネント作成（1時間）
1. EngineerSidebar.tsxの作成
2. メニュー項目の定義
3. スタイリングの実装

### Phase 2：レイアウト更新（30分）
1. layout.tsxの修正
2. ロール判定ロジックの実装
3. コンポーネント切り替えの実装

### Phase 3：動作確認（30分）
1. ログインテスト
2. 表示確認
3. 不具合修正

## 成功基準
1. engineer_test@duesk.co.jpでログイン時、エンジニア専用サイドバーが表示される
2. 管理者ロールでログイン時、AdminSidebarが表示される
3. 全てのメニュー項目が正しく動作する
4. モバイル表示でも適切に動作する

## 次のステップ
IMPLEMENTフェーズに移行し、上記計画に従って実装を進める。