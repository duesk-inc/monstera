# サイドメニューレイアウト改修実装計画書

## 計画日時
2025-07-13 00:52:40

## ブランチ
feature/sidebar-layout

## 概要
サイドメニューとメインコンテンツのレイアウト問題を解決するため、Flexboxレイアウトへの統一を実施する。

## 実装方針

### 1. アーキテクチャ変更
- 現在の`position: fixed` + `marginLeft`によるレイアウトを廃止
- Flexboxベースのレイアウトシステムに移行
- サイドバーとメインコンテンツが自然に連動するレスポンシブ設計

### 2. 期待される動作
- **サイドバーが閉じている時**: メインコンテンツが画面幅を最大限活用
- **サイドバーが開いている時**: メインコンテンツがサイドバーの幅分だけ自動的に縮小
- 画面からのはみ出しを完全に防止

## 詳細実装タスク

### 優先度: 高

#### 1. SharedLayoutWrapper.tsxの改修
- **実装内容**:
  - flexboxコンテナとしての再設計
  - `marginLeft`プロパティの削除
  - サイドバー開閉に応じた動的なレイアウト調整
- **変更箇所**:
  ```tsx
  // 変更前
  sx={{
    marginLeft: !isMobile ? sidebarWidth : 0,
    transition: 'margin-left 0.2s ease-in-out, width 0.2s ease-in-out',
  }}
  
  // 変更後
  sx={{
    flexGrow: 1,
    width: '100%',
    transition: 'width 0.2s ease-in-out',
  }}
  ```

#### 2. Sidebar.tsxの改修
- **実装内容**:
  - `position: fixed`の削除
  - flexboxアイテムとしての設定追加
  - スクロール動作の最適化
- **変更箇所**:
  ```tsx
  // position設定の削除
  // flex-shrink: 0の追加
  ```

#### 3. AdminSidebar.tsxの改修
- **実装内容**:
  - MUI Drawerコンポーネントの設定調整
  - flexbox対応のスタイル追加
- **変更箇所**:
  - Drawerのvariantプロパティの見直し
  - スタイリングの調整

### 優先度: 中

#### 4. レスポンシブ動作の検証
- モバイル/タブレット/デスクトップ各サイズでの動作確認
- ブレークポイントでの適切な切り替え

#### 5. アニメーション効果の調整
- サイドバー開閉時のスムーズなトランジション
- パフォーマンスへの影響確認

#### 6. 全画面での動作確認
- ダッシュボード
- 各管理画面
- フォーム画面での表示確認

## ファイル変更計画

### 修正対象ファイル
1. `/frontend/src/components/common/layout/SharedLayoutWrapper.tsx`
   - flexboxレイアウトの実装
   - marginLeft関連コードの削除

2. `/frontend/src/components/ui/Sidebar.tsx`
   - position: fixedの削除
   - flexbox対応スタイルの追加

3. `/frontend/src/components/ui/AdminSidebar.tsx`
   - Drawerコンポーネントの設定調整
   - flexbox対応

### 新規作成ファイル
なし

### 削除ファイル
なし

## テスト戦略

### 1. 単体テスト
- 各コンポーネントのprops動作確認
- サイドバー開閉状態の管理テスト

### 2. 統合テスト
- SharedLayoutWrapperとサイドバーコンポーネントの連携確認
- レイアウト全体の動作検証

### 3. E2Eテスト（重要）
- **デスクトップ環境**:
  - サイドバー開閉時のレイアウト動作
  - コンテンツのはみ出し確認
  - スクロール動作の検証
- **モバイル環境**:
  - ドロワー動作の確認
  - タッチ操作の検証
- **ブラウザ互換性**:
  - Chrome, Firefox, Safari, Edgeでの動作確認

## リスク分析と対策

### 1. z-index階層への影響
- **リスク**: position: fixed削除により重なり順が変わる可能性
- **対策**: 必要に応じてz-indexの再調整を実施

### 2. モバイルレイアウトへの影響
- **リスク**: flexbox変更でモバイル表示が崩れる可能性
- **対策**: メディアクエリでの適切な対応を確認

### 3. アニメーション効果の不具合
- **リスク**: トランジションが正しく動作しない可能性
- **対策**: CSSトランジションプロパティの調整

### 4. 既存機能への影響
- **リスク**: 他のページやコンポーネントへの予期しない影響
- **対策**: 全画面での網羅的な動作確認

## 実装スケジュール

1. **Phase 1**: SharedLayoutWrapper.tsxの改修（1時間）
2. **Phase 2**: Sidebar.tsx, AdminSidebar.tsxの改修（1時間）
3. **Phase 3**: レスポンシブ・アニメーション調整（30分）
4. **Phase 4**: テスト実施（1時間）
5. **Phase 5**: 問題修正・最終確認（30分）

**合計予定時間**: 約4時間

## 成功基準

1. サイドバー閉じた状態でメインコンテンツの余計な余白が解消される
2. サイドバー開いた状態でメインコンテンツのはみ出しが防止される
3. すべてのデバイスサイズで適切に表示される
4. アニメーション効果がスムーズに動作する
5. 既存機能に影響を与えない

## 次のステップ
IMPLEMENTフェーズへ移行し、上記計画に従って実装を開始する。