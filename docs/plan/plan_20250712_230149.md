# サイドメニューレイアウト実装計画書

## 作成日時
2025年7月12日 23:01:49

## 概要
サイドメニューが開いている状態でコンテンツの左端が隠れる問題を修正する実装計画。

## 調査結果サマリー
- **調査ファイル**: `docs/investigate/investigate_20250712_205222.md`
- **根本原因**: サイドバーが`position: fixed`で配置されているが、メインコンテンツに適切な`margin-left`が設定されていない
- **解決方針**: SharedLayoutWrapperコンポーネントにマージン設定を追加

## 実装方針

### 1. 基本アプローチ
SharedLayoutWrapperコンポーネントのメインコンテンツ部分に、サイドバーの幅に応じた`marginLeft`を動的に設定する。

### 2. 実装詳細
```typescript
// デスクトップ環境でのマージン設定
marginLeft: !isMobile ? sidebarWidth : 0
```

### 3. 条件分岐
- **デスクトップ環境**: サイドバーの幅に応じてマージンを設定
- **モバイル環境**: マージンは0（ドロワー形式のため）

## 詳細実装タスク

### タスク1: SharedLayoutWrapper.tsxの修正（優先度: 高）
**説明**: メインコンテンツにmarginLeftを追加
**対象箇所**: 93-99行目のBox component（main）のsx属性
**実装内容**:
```typescript
sx={{
  flexGrow: 1,
  width: '100%',
  marginLeft: !isMobile ? sidebarWidth : 0,
  transition: 'margin-left 0.2s ease-in-out, width 0.2s ease-in-out',
}}
```

### タスク2: デスクトップ環境での動作確認（優先度: 高）
**説明**: サイドバー開閉時の表示確認
**確認項目**:
- サイドバーが開いている時: コンテンツが正しく表示される
- サイドバーが閉じている時: コンテンツが適切に拡張される
- アニメーションが滑らかに動作する

### タスク3: モバイル環境での動作確認（優先度: 高）
**説明**: レスポンシブ対応の確認
**確認項目**:
- ドロワー形式でサイドバーが表示される
- コンテンツにマージンが適用されない
- 画面サイズ変更時の挙動が正しい

### タスク4: 管理者レイアウトでの動作確認（優先度: 中）
**説明**: 管理者画面でも同様に動作することを確認
**確認項目**:
- 管理者用サイドバーでも同じ挙動
- スタイルの競合がない

## ファイル変更計画

### 修正ファイル
1. `/frontend/src/components/common/layout/SharedLayoutWrapper.tsx`
   - 93-99行目: メインコンテンツのsx属性にmarginLeft追加
   - 変更内容: `marginLeft: !isMobile ? sidebarWidth : 0` を追加

### 新規作成ファイル
なし

### 削除ファイル
なし

## テスト戦略

### 手動テスト（優先度: 高）
1. **デスクトップ表示テスト**
   - Chrome、Firefox、Safariでの表示確認
   - サイドバー開閉時の動作確認
   - 画面幅1200px以上での確認

2. **モバイル表示テスト**
   - 画面幅768px以下での確認
   - ドロワー動作の確認
   - タッチ操作の確認

3. **レスポンシブテスト**
   - ブレークポイント前後での動作確認
   - リサイズ時の挙動確認

### 自動テスト（優先度: 低）
この変更は視覚的な修正のため、E2Eテストは必須ではないが、既存のレイアウトテストがある場合は実行する。

## リスク分析と対策

### リスク1: 既存レイアウトへの影響
**可能性**: 低
**影響度**: 中
**対策**: 
- !isMobile条件により、モバイル環境への影響を防ぐ
- transitionの設定により、滑らかな変更を保証

### リスク2: パフォーマンスへの影響
**可能性**: 極低
**影響度**: 低
**対策**: 
- CSSプロパティの変更のみで、再レンダリングは最小限
- 既存のtransition設定を活用

### リスク3: ブラウザ互換性
**可能性**: 極低
**影響度**: 低
**対策**: 
- margin-leftは全ブラウザでサポート
- Material-UIのBox componentを使用しているため、互換性は保証

## 実装時間見積もり
- 実装: 10分
- テスト: 20分
- 合計: 30分

## 次のステップ
1. IMPLEMENTフェーズでSharedLayoutWrapper.tsxを修正
2. 開発環境で動作確認
3. 問題がなければコミット

## 備考
- この修正は最小限の変更で問題を解決する
- 既存のアーキテクチャとの整合性を保つ
- 将来的な拡張性も考慮済み