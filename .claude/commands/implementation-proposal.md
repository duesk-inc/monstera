# IMPLEMENTATION-PROPOSAL フェーズ

# ユーザの入力
#$ARGUMENTS

## 目的
要件に対する複数の実装アプローチを検討し、技術的観点・ビジネス観点から最適な実装案を提案する。

## 注意事項
- **Model: Opus** - 実装案の比較検討には必ず**ultrathink**で深く検討すること
- Serenaのコード分析機能を活用し、既存実装との整合性を確保すること
- 短期的な実装容易性と長期的な保守性のバランスを考慮すること
- パフォーマンス、セキュリティ、拡張性を総合的に評価すること

## 必要な入力
- 実装したい機能の要件
- 制約条件（期限、リソース、技術的制約など）
- 優先順位（パフォーマンス重視、保守性重視など）

## Serena活用ポイント
```bash
# 1. 既存実装パターンの分析
read_memory("coding_conventions")
get_symbols_overview("類似機能のディレクトリ")
search_for_pattern("類似実装パターン")

# 2. アーキテクチャ分析
find_symbol("関連するインターフェース")
find_referencing_symbols("拡張ポイント")

# 3. パフォーマンス考慮点の確認
search_for_pattern("キャッシュ実装")
search_for_pattern("非同期処理")
```

## タスクに含まれるべきTODO
1. ユーザの要件を理解し、提案作成開始をコンソールで通知
2. Serenaメモリから設計原則・実装パターンを確認
3. **ultrathinkで要件を深く分析**
   - 機能要件の整理
   - 非機能要件の整理
   - 制約条件の整理
4. **既存システムの調査**
   - 類似機能の実装パターン確認
   - 利用可能なコンポーネント/ライブラリ確認
   - アーキテクチャ上の制約確認
5. **実装アプローチの洗い出し（最低3案）**
   - アプローチ1: 標準的な実装
   - アプローチ2: パフォーマンス重視の実装
   - アプローチ3: 拡張性重視の実装
6. **各アプローチの詳細設計**
   - アーキテクチャ図
   - データフロー
   - 主要コンポーネント
   - 技術スタック
7. **比較評価**
   - 実装工数
   - パフォーマンス特性
   - 保守性・可読性
   - 拡張性・柔軟性
   - セキュリティ
   - テスト容易性
8. **リスク分析**
   - 技術的リスク
   - スケジュールリスク
   - 運用リスク
9. **推奨案の選定と根拠**
10. **実装ロードマップ**
    - フェーズ分け
    - マイルストーン
    - 必要リソース
11. **プロトタイプコード**（必要に応じて）
12. 提案内容を `docs/proposal/implementation-proposal_{TIMESTAMP}.md` に保存
13. 選定した実装パターンをSerenaメモリに保存
14. `afplay /System/Library/Sounds/Sosumi.aiff` で完了通知
15. 提案書ファイル名、推奨案をコンソール出力

## 評価マトリクス
| 評価項目 | 重み | アプローチ1 | アプローチ2 | アプローチ3 |
|---------|------|------------|------------|------------|
| 実装工数 | 20% | - | - | - |
| パフォーマンス | 25% | - | - | - |
| 保守性 | 20% | - | - | - |
| 拡張性 | 15% | - | - | - |
| セキュリティ | 10% | - | - | - |
| テスト容易性 | 10% | - | - | - |

## 提案書に含めるべき内容
- [ ] エグゼクティブサマリー
- [ ] 要件の整理
- [ ] 各アプローチの詳細
- [ ] 比較評価結果
- [ ] リスクと対策
- [ ] 推奨案と根拠
- [ ] 実装計画
- [ ] 必要なリソース

## 出力ファイル
- `docs/proposal/implementation-proposal_{TIMESTAMP}.md`

## 最終出力形式
### 提案完了の場合
status: SUCCESS
next: NEW-FEATURE-PLAN
details: "実装提案完了。implementation-proposal_{TIMESTAMP}.mdに詳細記録。推奨案: [案の名前]。計画フェーズへ移行可能。"

### 追加調査が必要な場合
status: NEED_INVESTIGATION
next: INVESTIGATE
details: "基本提案完了。implementation-proposal_{TIMESTAMP}.mdに記録。[調査項目]の詳細調査が必要。"

### 要件の明確化が必要な場合
status: NEED_CLARIFICATION
next: USER_INPUT
details: "提案作成中。implementation-proposal_{TIMESTAMP}.mdに途中経過記録。[不明な要件]の明確化が必要。"